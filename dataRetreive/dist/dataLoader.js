"use strict";

var _fs = require("fs");

var stringify = function stringify(data) {
  var stringifyElement = function stringifyElement(e) {
    return e.reduce(function (res, e, i) {
      if (i !== 0) {
        return res + ("\"" + e + "\", ");
      } else return res;
    }, "");
  };

  return data.reduce(function (res, e) {
    return res + ("[" + stringifyElement(e) + "], ");
  }, "");
};

var dataLoader = function dataLoader(id) {
  var fileName = "factbook/rankorder/rawdata_" + id + ".txt";
  var content = (0, _fs.readFileSync)(fileName).toString();

  var rows = content.split("\r");

  var data = rows.map(function (e) {
    return e.split(/\t\s*/);
  });

  if (data.length < 10) return "";

  var output = "[" + stringify(data) + "]";

  return output;
};

(0, _fs.writeFileSync)("data.js", "\n  // This file is auto-generated, please do not edit this file.\n  export default {\n");
(0, _fs.readdirSync)('factbook/rankorder/').forEach(function (fileName) {
  if (/[0-9]*rank.html/.test(fileName)) {
    var id = parseInt(fileName.substr(0, 4));
    var out = dataLoader(id);
    if (out.length > 10) {
      (0, _fs.appendFileSync)("data.js", id + ": ");
      (0, _fs.appendFileSync)("data.js", dataLoader(id));
      (0, _fs.appendFileSync)("data.js", ", \n");
    }
  }
});
(0, _fs.appendFileSync)("data.js", "}");